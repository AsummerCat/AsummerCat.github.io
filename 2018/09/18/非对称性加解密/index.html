<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/%E9%A3%9E%E5%A4%A9%E5%B0%8F%E5%A5%B3%E8%AD%A6_%E8%8A%B1%E8%8A%B1.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/%E9%A3%9E%E5%A4%A9%E5%B0%8F%E5%A5%B3%E8%AD%A6_%E8%8A%B1%E8%8A%B1.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.geekzu.org/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"www.linjingc.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="对称性加解密and非对称性加解密例子Main.java"><meta property="og:type" content="article"><meta property="og:title" content="非对称性加解密"><meta property="og:url" content="http://www.linjingc.top/2018/09/18/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86/index.html"><meta property="og:site_name" content="emmm读书使我快乐"><meta property="og:description" content="对称性加解密and非对称性加解密例子Main.java"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-09-17T20:16:08.000Z"><meta property="article:modified_time" content="2023-12-06T03:17:10.842Z"><meta property="article:author" content="一只写Bug的猫"><meta property="article:tag" content="java"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://www.linjingc.top/2018/09/18/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://www.linjingc.top/2018/09/18/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86/","path":"2018/09/18/非对称性加解密/","title":"非对称性加解密"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>非对称性加解密 | emmm读书使我快乐</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">emmm读书使我快乐</p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86and%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="nav-number">1.</span> <span class="nav-text">对称性加解密and非对称性加解密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90"><span class="nav-number">1.1.</span> <span class="nav-text">例子</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Main-java"><span class="nav-number">1.1.1.</span> <span class="nav-text">Main.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AES-java"><span class="nav-number">1.1.2.</span> <span class="nav-text">AES.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#base64-java"><span class="nav-number">1.1.3.</span> <span class="nav-text">base64.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HexUtil-java"><span class="nav-number">1.1.4.</span> <span class="nav-text">HexUtil.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSAEncrypt-java"><span class="nav-number">1.1.5.</span> <span class="nav-text">RSAEncrypt.java</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="一只写Bug的猫" src="/img/WechatIMG230.jpeg"><p class="site-author-name" itemprop="name">一只写Bug的猫</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">841</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">200</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://www.linjingc.top/2018/09/18/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E8%A7%A3%E5%AF%86/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/WechatIMG230.jpeg"><meta itemprop="name" content="一只写Bug的猫"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="emmm读书使我快乐"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="非对称性加解密 | emmm读书使我快乐"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">非对称性加解密</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-09-17 20:16:08" itemprop="dateCreated datePublished" datetime="2018-09-17T20:16:08Z">2018-09-17</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-12-06 03:17:10" itemprop="dateModified" datetime="2023-12-06T03:17:10Z">2023-12-06</time> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>21k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>20 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="对称性加解密and非对称性加解密"><a href="#对称性加解密and非对称性加解密" class="headerlink" title="对称性加解密and非对称性加解密"></a>对称性加解密and非对称性加解密</h1><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="Main-java"><a href="#Main-java" class="headerlink" title="Main.java"></a>Main.java</h3><span id="more"></span><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.*;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.InvalidKeySpecException;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">        asymment();<span class="comment">//非对称</span></span><br><span class="line">        symmetry();<span class="comment">//对称</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 字符串生成公钥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RSAPublicKey <span class="title function_">loadPublicKeyByStr</span><span class="params">(String publicKeyStr)</span></span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] buffer = Base64.decode(publicKeyStr);</span><br><span class="line">            <span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line">            <span class="type">X509EncodedKeySpec</span> <span class="variable">keySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">X509EncodedKeySpec</span>(buffer);</span><br><span class="line">            <span class="keyword">return</span> (RSAPublicKey) keyFactory.generatePublic(keySpec);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;无此算法&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvalidKeySpecException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;公钥非法&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;公钥数据为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 字符串生成私钥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RSAPrivateKey <span class="title function_">loadPrivateKeyByStr</span><span class="params">(String privateKeyStr)</span></span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] buffer = Base64.decode(privateKeyStr);</span><br><span class="line">            <span class="type">PKCS8EncodedKeySpec</span> <span class="variable">keySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PKCS8EncodedKeySpec</span>(buffer);</span><br><span class="line">            <span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (RSAPrivateKey) keyFactory.generatePrivate(keySpec);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;无此算法&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvalidKeySpecException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;私钥非法&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;私钥数据为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 非对称加解密</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">asymment</span><span class="params">()</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;非对称公钥加密的字段&quot;</span>;</span><br><span class="line">        <span class="type">KeyPairGenerator</span> <span class="variable">keyPairGen</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line">        <span class="comment">// 密钥位数</span></span><br><span class="line">        keyPairGen.initialize(<span class="number">512</span>);</span><br><span class="line">        <span class="comment">//密钥对</span></span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> keyPairGen.generateKeyPair();  <span class="comment">//随机生成公钥私钥</span></span><br><span class="line">        <span class="comment">// 随机公钥</span></span><br><span class="line">        <span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> (RSAPublicKey) keyPair.getPublic();</span><br><span class="line">        <span class="comment">// 随机私钥</span></span><br><span class="line">        <span class="type">PrivateKey</span> <span class="variable">privateKey</span> <span class="operator">=</span> (RSAPrivateKey) keyPair.getPrivate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">////// 自定义非对称公钥</span></span><br><span class="line">        <span class="comment">//PublicKey publicKey = loadPublicKeyByStr(&quot;MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAppqfv16PMKDrbrPUd2/WDcB27fgMfriFKKJ81O8kVZwmss0ZH/vYNRI9fbc+MehU4rQkrpehrMBNhpcLphMld3BqYQXOcOmi7vlJOgUPaSXvmwCodBRrFErvtEbFP/R11+cffJwpbOwyDJ+QowO58DfkcvsdOpP+oXLmTkT+i803sX5cU62eQ8KgED55MvQr37qNQiA5i9NLKN9aZoSHJgJn0KW0zH3iFgdUB3cmpCGfEdTRffO86NvDhsqfBjw+zJ5JG4O7lq0CKZczpvhSxsE4BMBEKdrAC62CZa1uw/dPet3nwIR+O4e1qH9EauqdrkVQ5KHWVi8Mx7FTgsAH XLxyDGVbErBHzdrjJwRMXaQHuhzxmLFDIVKB/DerYPLjPJdJbup9PmhmFBjApYuR BEMDaeiIKe+/P0SbAm389hgc8MAAccP/qDj4OmLp/tB7C/N4PwL8EGlIZ02khjXRuMzjOuFNTVRmpLHLezFy42nR3WoGWJrjZfA6X1e9T00R21c5nfULqxrgBPaD7amGF7pnJiINF+ZCdHac63AaOmlzImv3NNqrxaONFCWvrtOo46qP7p9fk0ypAwjr9F3d 55ha5SK89uenUzrd5qzlOh9iGo+vgixGCgcVLE9dXcNPldOVMZp5757w+/B1Q2d4hvoEgw1uaLxYtny5ZG5X468CAwEAAQ==&quot;);</span></span><br><span class="line">        <span class="comment">////// 自定义非对称私钥</span></span><br><span class="line">        <span class="comment">//PrivateKey privateKey = loadPrivateKeyByStr(&quot;MIIJQgIBADANBgkqhkiG9w0BAQEFAASCCSwwggkoAgEAAoICAQCmmp+/Xo8woOtus9R3b9YNwHbt+Ax+uIUoonzU7yRVnCayzRkf+9g1Ej19tz4x6FTitCSul6GswE2GlwumEyV3cGphBc5w6aLu+Uk6BQ9pJe+bAKh0FGsUSu+0RsU/9HXX5x98nCls7DIMn5CjA7nwN+Ry+x06k/6hcuZORP6LzTexflxTrZ5DwqAQPnky9Cvfuo1CIDmL00so31pmhIcmAmfQpbTMfeIWB1QHdyakIZ8R1NF987zo28OGyp8GPD7Mnkkbg7uWrQIplzOm+FLGwTgEwEQp2sALrYJlrW7D90963efAhH47h7Wof0Rq6p2uRVDkodZWLwzHsVOCwAdcvHIMZVsSsEfN2uMnBExdpAe6HPGYsUMhUoH8N6tg8uM8l0lu6n0+aGYUGMCli5EEQwNp6Igp778/RJsCbfz2GBzwwABxw/+oOPg6Yun+0HsL83g/AvwQaUhnTaSGNdG4zOM64U1NVGaksct7MXLjadHdagZYmuNl8DpfV71PTRHbVzmd9QurGuAE9oPtqYYXumcmIg0X5kJ0dpzrcBo6aXMia/c02qvFo40UJa+u06jjqo/un1+TTKkDCOv0Xd3nmFrlIrz256dTOt3mrOU6H2Iaj6+CLEYKBxUsT11dw0+V05UxmnnvnvD78HVDZ3iG+gSDDW5ovFi2fLlkblfjrwIDAQABAoICAARtq71ceBXk0R06LnWWRWxMJ10f8MUVhoST/Rlz2dVktyqdhQNyoEaY24WR71dIQ6la/HaflS6QVf8z2J1reN154Xn+u4QI0cnkWmvuYoB6/6lxFQkw2b/KViDGmMugZdl9TTr0s60vgg0P2LpciP63nZzoy9gYwvXrpe+CqflxVP+kyjN3M/O9IqAL6RDPqLLjtImDbcQns6G8fhynfSgnfDbxkKK23eGUBEnGgwJt2lqQ+5iLeAQAg2v7yspRo6Gwu2S91ailpJ8SY88WXqzlyeVmbull5SDqVcL6Hy2aT0SGzXgyjWBrtQprh5gH8HUHZqUNIDNeQMq2DfA1xnxHkzhTvFyFu9gNC8oKgPlE1zjTONadDu71GYJj9JFNnusJsb+uNekqH+JfJnNWUJxDkCdKB76rDRQ9y/IcCW4QX48b9lt95spoxdbypS90Hi8469oQjgRzuNbco2pS3OquACj7vUH9Bg5BOM+N4uYJf3khBFuoKohXUbFDKcJr48a5yiucBu6BYe1KPA+zlkrLKX+Xs2ejjhGYJliQyUX6sIeg55POKAMrqFTNQeDk1iMpH4IREtbjstOg+TPS+UONjJvzjBcJeEJ+Q/7pY8Wu8J4krqCog2myP1FulXetfAZWAIj4Ovd8M73MCNPh+b3h2kbtvsboEtuTPHlt4XwRAoIBAQDRAbCXccMTPJyWHVhFgLb9lxlHvdS9pDUuZn2twRDsHJicsB418MK+BsGpgmSp4Xu9lNvmAiYQAk/d0d6qWjEewh3nmOq/T3mPVisUtuYsDfjWcK73bjjZGePGTiNHhhncX0MCiJ7hE1rjmxPZ2gbCIFGXv/nrCUyOTzxVy/T9g0WDwnn1QS2Qrg7jdo7imC+uvQcn0Pv3z62Anxi7QJMoxWpwxD2bBZQr9XxAIf2xopYmLXK2kpvlLmqxozrGTfV9yfmbz88OL1X2CD0qB8vyeCkrQXHMdjl83HDdOfnSIpnZUptJQnGZKFT/o44boLvjQcydPH7IAhqp1RA6OIstAoIBAQDMEENE2IUXjW2vMYPA/2nWRqXDneSXZeaNQqjw8EzEBlLEsmPQ0x1QR7xixyVvXEUwbdd2LI/0WWblb4JoS8F52d73WAe3DZoBeiDefgeyllHZRW8RIFuRwWKv22N6T4JLgXjp5tDMFMpaOt7c987IY9xINc/EZe2cZxVcnMQr9tWrXHuOjd2al0NZr+ok+6ocFLOFsqdmaJ18nQUX7Fn1XI0nG++lXt7s7/6Ik4xJ2HPVs24CiDIbsMY4mEI8lSinCJ3pFoMHIP70hiHQEGn0u1hdjn3WP8PzlonJ4vwM2PNzOaB95rUbWm8hOS2u8o972A26TgiwxcKbVa6tYAPLAoIBACqmy6C8KHD+h33i0yar06wAb7pCNO3WWrvzUmZo5ckpNMOU9TVQwo0A1/h9kYlRaG0RuaZAff/6WM4NjAD7ktaSCoQ+onkUANyNWxFJGcOXvlYUfMAlkBhNvjuzqmNoLFLaZdRYiQOpbXzRIsXsRkDLU5tCJAAgz6yi4s8nZgFuDnuK7lRsTp4dxxAIG7SGFgT0skcf0KuLh/6dePCNhvpk/wmwIlpGUyx9VjPIO/tKEJYN5ED5vjKQvFkv1EivlA9tbjCrwbdFVad1mvW+zZHXj58yJcTxw12FpsqekCqfwQGmZ+YVVxVIM8BPYiqlLHJ99QGJXN33//T0c/FNpKkCggEBAMjUEIAG3yUIyTOr9VDRjWWWbbkRAVGGtdm8CuvkcohQ+NAgCGASBT1m/B3yhAMOugEpeO0SejIucjfHAH6IX8b+BpNCjYU326MsgIC3Y/f8PF0qGl6ui6/stKUBsutCqKaKq2b3A/J1W5hla8PoFhfdP4PJgcp1zd0pDjrxBZeG+04EXI01TSzBRUVU/YicLRQpw2wHIPyGZMeo+MRMlVQGW9xrf/QuZBKnNsdO/rgGUCm2xsOzKi1aUhqMrlNVMIcC0fX9c8JmVMRt5YURQlXasuKQQ4PBiaWHN9/6hbhXI3D4+9wsW3yqCciWr0EH8vIc9ZWvCpp+ZkHdl2WFovUCggEAYC7bgkjSMRgir5cv+iKvGE1Mte+Js02x4JD19tXf8AR250RH8Tj+fIiCB0C2vKNHBsy9vkOv+P6P4TAm9JDX7AFk3RiBf9f80/z4dBaOmnJs+TJm/9whtZKmola4m8EKQ97lFfVAIsobK4AMFPiFm0jSG7XNmJgMURNoMVXl5qHpf0niwX9FoVdQBjK6WZD/rlb46QRSa/yMxgB2OU1XED1b7QAIlHpilu48To7QW1G/Aux/7FJVg3OMjPhkvRZ1eI4KEpUa7VO62tfqpdfm/ulNxPDOo414PUCmgmo4mnLUGzOhgUJ9tYmPYzmzOT4WU6nSnWs11fagSZ7BWqDCBg==&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">RSAEncrypt</span> <span class="variable">rsaEncrypt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RSAEncrypt</span>(publicKey, privateKey);</span><br><span class="line">        <span class="type">String</span> <span class="variable">afterRSAEncrypt</span> <span class="operator">=</span> rsaEncrypt.encrypt(pwd);</span><br><span class="line">        System.out.println(<span class="string">&quot;rsa加密后\t&quot;</span> + afterRSAEncrypt);</span><br><span class="line">        System.out.println(<span class="string">&quot;rsa解密后:\t&quot;</span> + rsaEncrypt.decrypt(afterRSAEncrypt));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对称加解密</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">symmetry</span><span class="params">()</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;对称加密的字段&quot;</span>;     <span class="comment">//加密字段</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ascKey</span> <span class="operator">=</span> <span class="string">&quot;lianghuilonglong&quot;</span>;   <span class="comment">//加密key</span></span><br><span class="line">    String iv=<span class="string">&quot;aabbccddeeffgghh&quot;</span>;  <span class="comment">//初始化向量参数，AES 为16bytes. DES 为8bytes</span></span><br><span class="line"></span><br><span class="line">    String afterASCEncrypt=AES.encrypt(pwd,ascKey,iv);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;asc加密后:\t&quot;</span> + afterASCEncrypt);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;asc解密后:\t&quot;</span> + AES.deCiphering(afterASCEncrypt,ascKey,iv));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AES-java"><a href="#AES-java" class="headerlink" title="AES.java"></a>AES.java</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.<span class="property">crypto</span>.<span class="property">Cipher</span>;</span><br><span class="line"><span class="keyword">import</span> javax.<span class="property">crypto</span>.<span class="property">spec</span>.<span class="property">IvParameterSpec</span>;</span><br><span class="line"><span class="keyword">import</span> javax.<span class="property">crypto</span>.<span class="property">spec</span>.<span class="property">SecretKeySpec</span>;</span><br><span class="line"><span class="keyword">import</span> java.<span class="property">security</span>.<span class="property">Key</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AES</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">String</span> <span class="title function_">encrypt</span>(<span class="built_in">String</span> <span class="built_in">text</span>,<span class="built_in">String</span> <span class="built_in">key</span>,<span class="built_in">String</span> iv) <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//String text = &quot;abcdefg&quot;;   //要加密的字符串</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//String key = &quot;lianghuilonglong&quot;;//私钥： AES固定格式为128/192/256 bits.即：16/24/32bytes。DES固定格式为128bits，即8bytes。</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//String iv   = &quot;aabbccddeeffgghh&quot;;//初始化向量参数，AES 为16bytes. DES 为8bytes.</span></span><br><span class="line"></span><br><span class="line">  Key keySpec = <span class="keyword">new </span><span class="class title_">SecretKeySpec</span>(<span class="built_in">key</span>.<span class="property">getBytes</span>(), <span class="string">&quot;AES&quot;</span>);    <span class="comment">//两个参数，第一个为私钥字节数组， 第二个为加密方式 AES或者DES</span></span><br><span class="line"></span><br><span class="line">  IvParameterSpec ivSpec = <span class="keyword">new </span><span class="class title_">IvParameterSpec</span>(iv.<span class="property">getBytes</span>());  <span class="comment">// 初始化向量</span></span><br><span class="line"></span><br><span class="line">  Cipher cipher = Cipher.<span class="property">getInstance</span>(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>); <span class="comment">// 实例化加密类，参数为加密方式，要写全</span></span><br><span class="line"></span><br><span class="line">cipher.<span class="property">init</span>(Cipher.<span class="property">ENCRYPT_MODE</span>,  keySpec, ivSpec);      <span class="comment">// 初始化，此方法可以采用三种方式，按服务器要求来添加。</span></span><br><span class="line">        <span class="comment">//（1）无第三个参数</span></span><br><span class="line">        <span class="comment">//（2）第三个参数为SecureRandom random = new SecureRandom();中random对象，随机数。(AES不可采用这种方法)</span></span><br><span class="line">        <span class="comment">//（3）采用此代码中的IVParameterSpec</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//cipher.init(Cipher.ENCRYPT_MODE, keySpec);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//SecureRandom random = new SecureRandom();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//cipher.init(Cipher.ENCRYPT_MODE, keySpec, random);</span></span><br><span class="line"></span><br><span class="line">  <span class="type">byte</span> [] b = cipher.<span class="property">doFinal</span>(<span class="built_in">text</span>.<span class="property">getBytes</span>());<span class="comment">//加密操作,返回加密后的字节数组，然后需要编码。主要编解码方式有Base64, HEX, UUE,7bit等等。</span></span><br><span class="line">   <span class="built_in">String</span> ret = Base64.<span class="property">encode</span>(b);   <span class="comment">//Base64、HEX等编解码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">String</span> <span class="title function_">deCiphering</span>(<span class="built_in">String</span> textDeCipher, <span class="built_in">String</span> keySpec,<span class="built_in">String</span> iv)<span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//String keySpec = &quot;lianghuilonglong&quot;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//String textDeCipher = &quot;UstyI8JoQOty8egSMFQfig==&quot;;   //从服务器返回的加密字符串，需要解密的字符串</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//String iv   = &quot;aabbccddeeffgghh&quot;;//初始化向量参数，AES 为16bytes. DES 为8bytes</span></span><br><span class="line">    <span class="type">byte</span> [] info = Base64.<span class="property">decode</span>(textDeCipher);     <span class="comment">//先用Base64解码</span></span><br><span class="line"></span><br><span class="line">       IvParameterSpec ivSpec = <span class="keyword">new </span><span class="class title_">IvParameterSpec</span>(iv.<span class="property">getBytes</span>());</span><br><span class="line"></span><br><span class="line">    Key <span class="built_in">key</span> = <span class="keyword">new </span><span class="class title_">SecretKeySpec</span>(keySpec.<span class="property">getBytes</span>(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Cipher cipher = Cipher.<span class="property">getInstance</span>(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line"></span><br><span class="line">    cipher.<span class="property">init</span>(Cipher.<span class="property">DECRYPT_MODE</span>, <span class="built_in">key</span>, ivSpec);    <span class="comment">//与加密时不同MODE:Cipher.DECRYPT_MODE</span></span><br><span class="line"></span><br><span class="line">    <span class="type">byte</span> [] ret = cipher.<span class="property">doFinal</span>(info);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new </span><span class="class title_">String</span>(ret, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="base64-java"><a href="#base64-java" class="headerlink" title="base64.java"></a>base64.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Base64</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">BASELENGTH</span>           <span class="operator">=</span> <span class="number">128</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">LOOKUPLENGTH</span>         <span class="operator">=</span> <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">TWENTYFOURBITGROUP</span>   <span class="operator">=</span> <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">EIGHTBIT</span>             <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">SIXTEENBIT</span>           <span class="operator">=</span> <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">FOURBYTE</span>             <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span>     <span class="variable">SIGN</span>                 <span class="operator">=</span> -<span class="number">128</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">char</span>    <span class="variable">PAD</span>                  <span class="operator">=</span> <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">fDebug</span>               <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">private</span> <span class="type">byte</span>[]  base64Alphabet       = <span class="keyword">new</span> <span class="title class_">byte</span>[BASELENGTH];</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">private</span> <span class="type">char</span>[]  lookUpBase64Alphabet = <span class="keyword">new</span> <span class="title class_">char</span>[LOOKUPLENGTH];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; BASELENGTH; ++i) &#123;</span><br><span class="line">            base64Alphabet[i] = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="string">&#x27;Z&#x27;</span>; i &gt;= <span class="string">&#x27;A&#x27;</span>; i--) &#123;</span><br><span class="line">            base64Alphabet[i] = (<span class="type">byte</span>) (i - <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="string">&#x27;z&#x27;</span>; i &gt;= <span class="string">&#x27;a&#x27;</span>; i--) &#123;</span><br><span class="line">            base64Alphabet[i] = (<span class="type">byte</span>) (i - <span class="string">&#x27;a&#x27;</span> + <span class="number">26</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="string">&#x27;9&#x27;</span>; i &gt;= <span class="string">&#x27;0&#x27;</span>; i--) &#123;</span><br><span class="line">            base64Alphabet[i] = (<span class="type">byte</span>) (i - <span class="string">&#x27;0&#x27;</span> + <span class="number">52</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        base64Alphabet[<span class="string">&#x27;+&#x27;</span>] = <span class="number">62</span>;</span><br><span class="line">        base64Alphabet[<span class="string">&#x27;/&#x27;</span>] = <span class="number">63</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= <span class="number">25</span>; i++) &#123;</span><br><span class="line">            lookUpBase64Alphabet[i] = (<span class="type">char</span>) (<span class="string">&#x27;A&#x27;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">26</span>, j = <span class="number">0</span>; i &lt;= <span class="number">51</span>; i++, j++) &#123;</span><br><span class="line">            lookUpBase64Alphabet[i] = (<span class="type">char</span>) (<span class="string">&#x27;a&#x27;</span> + j);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">52</span>, j = <span class="number">0</span>; i &lt;= <span class="number">61</span>; i++, j++) &#123;</span><br><span class="line">            lookUpBase64Alphabet[i] = (<span class="type">char</span>) (<span class="string">&#x27;0&#x27;</span> + j);</span><br><span class="line">        &#125;</span><br><span class="line">        lookUpBase64Alphabet[<span class="number">62</span>] = (<span class="type">char</span>) <span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">        lookUpBase64Alphabet[<span class="number">63</span>] = (<span class="type">char</span>) <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isWhiteSpace</span><span class="params">(<span class="type">char</span> octect)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (octect == <span class="number">0x20</span> || octect == <span class="number">0xd</span> || octect == <span class="number">0xa</span> || octect == <span class="number">0x9</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isPad</span><span class="params">(<span class="type">char</span> octect)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (octect == PAD);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isData</span><span class="params">(<span class="type">char</span> octect)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (octect &lt; BASELENGTH &amp;&amp; base64Alphabet[octect] != -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encodes hex octects into Base64</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> binaryData Array containing binaryData</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Encoded Base64 array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encode</span><span class="params">(<span class="type">byte</span>[] binaryData)</span> &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (binaryData == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">lengthDataBits</span> <span class="operator">=</span> binaryData.length * EIGHTBIT;</span><br><span class="line">        <span class="keyword">if</span> (lengthDataBits == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">fewerThan24bits</span> <span class="operator">=</span> lengthDataBits % TWENTYFOURBITGROUP;</span><br><span class="line">        <span class="type">int</span> <span class="variable">numberTriplets</span> <span class="operator">=</span> lengthDataBits / TWENTYFOURBITGROUP;</span><br><span class="line">        <span class="type">int</span> <span class="variable">numberQuartet</span> <span class="operator">=</span> fewerThan24bits != <span class="number">0</span> ? numberTriplets + <span class="number">1</span> : numberTriplets;</span><br><span class="line">        <span class="type">char</span> encodedData[] = <span class="literal">null</span>;</span><br><span class="line"> </span><br><span class="line">        encodedData = <span class="keyword">new</span> <span class="title class_">char</span>[numberQuartet * <span class="number">4</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="type">byte</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>, l = <span class="number">0</span>, b1 = <span class="number">0</span>, b2 = <span class="number">0</span>, b3 = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">encodedIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">dataIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (fDebug) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;number of triplets = &quot;</span> + numberTriplets);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; numberTriplets; i++) &#123;</span><br><span class="line">            b1 = binaryData[dataIndex++];</span><br><span class="line">            b2 = binaryData[dataIndex++];</span><br><span class="line">            b3 = binaryData[dataIndex++];</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (fDebug) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;b1= &quot;</span> + b1 + <span class="string">&quot;, b2= &quot;</span> + b2 + <span class="string">&quot;, b3= &quot;</span> + b3);</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            l = (<span class="type">byte</span>) (b2 &amp; <span class="number">0x0f</span>);</span><br><span class="line">            k = (<span class="type">byte</span>) (b1 &amp; <span class="number">0x03</span>);</span><br><span class="line"> </span><br><span class="line">            <span class="type">byte</span> <span class="variable">val1</span> <span class="operator">=</span> ((b1 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b1 &gt;&gt; <span class="number">2</span>) : (<span class="type">byte</span>) ((b1) &gt;&gt; <span class="number">2</span> ^ <span class="number">0xc0</span>);</span><br><span class="line">            <span class="type">byte</span> <span class="variable">val2</span> <span class="operator">=</span> ((b2 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b2 &gt;&gt; <span class="number">4</span>) : (<span class="type">byte</span>) ((b2) &gt;&gt; <span class="number">4</span> ^ <span class="number">0xf0</span>);</span><br><span class="line">            <span class="type">byte</span> <span class="variable">val3</span> <span class="operator">=</span> ((b3 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b3 &gt;&gt; <span class="number">6</span>) : (<span class="type">byte</span>) ((b3) &gt;&gt; <span class="number">6</span> ^ <span class="number">0xfc</span>);</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (fDebug) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;val2 = &quot;</span> + val2);</span><br><span class="line">                System.out.println(<span class="string">&quot;k4   = &quot;</span> + (k &lt;&lt; <span class="number">4</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;vak  = &quot;</span> + (val2 | (k &lt;&lt; <span class="number">4</span>)));</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[val2 | (k &lt;&lt; <span class="number">4</span>)];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[(l &lt;&lt; <span class="number">2</span>) | val3];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[b3 &amp; <span class="number">0x3f</span>];</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// form integral number of 6-bit groups</span></span><br><span class="line">        <span class="keyword">if</span> (fewerThan24bits == EIGHTBIT) &#123;</span><br><span class="line">            b1 = binaryData[dataIndex];</span><br><span class="line">            k = (<span class="type">byte</span>) (b1 &amp; <span class="number">0x03</span>);</span><br><span class="line">            <span class="keyword">if</span> (fDebug) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;b1=&quot;</span> + b1);</span><br><span class="line">                System.out.println(<span class="string">&quot;b1&lt;&lt;2 = &quot;</span> + (b1 &gt;&gt; <span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">byte</span> <span class="variable">val1</span> <span class="operator">=</span> ((b1 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b1 &gt;&gt; <span class="number">2</span>) : (<span class="type">byte</span>) ((b1) &gt;&gt; <span class="number">2</span> ^ <span class="number">0xc0</span>);</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[k &lt;&lt; <span class="number">4</span>];</span><br><span class="line">            encodedData[encodedIndex++] = PAD;</span><br><span class="line">            encodedData[encodedIndex++] = PAD;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fewerThan24bits == SIXTEENBIT) &#123;</span><br><span class="line">            b1 = binaryData[dataIndex];</span><br><span class="line">            b2 = binaryData[dataIndex + <span class="number">1</span>];</span><br><span class="line">            l = (<span class="type">byte</span>) (b2 &amp; <span class="number">0x0f</span>);</span><br><span class="line">            k = (<span class="type">byte</span>) (b1 &amp; <span class="number">0x03</span>);</span><br><span class="line"> </span><br><span class="line">            <span class="type">byte</span> <span class="variable">val1</span> <span class="operator">=</span> ((b1 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b1 &gt;&gt; <span class="number">2</span>) : (<span class="type">byte</span>) ((b1) &gt;&gt; <span class="number">2</span> ^ <span class="number">0xc0</span>);</span><br><span class="line">            <span class="type">byte</span> <span class="variable">val2</span> <span class="operator">=</span> ((b2 &amp; SIGN) == <span class="number">0</span>) ? (<span class="type">byte</span>) (b2 &gt;&gt; <span class="number">4</span>) : (<span class="type">byte</span>) ((b2) &gt;&gt; <span class="number">4</span> ^ <span class="number">0xf0</span>);</span><br><span class="line"> </span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[val2 | (k &lt;&lt; <span class="number">4</span>)];</span><br><span class="line">            encodedData[encodedIndex++] = lookUpBase64Alphabet[l &lt;&lt; <span class="number">2</span>];</span><br><span class="line">            encodedData[encodedIndex++] = PAD;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(encodedData);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decodes Base64 data into octects</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encoded string containing Base64 data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Array containind decoded data.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] decode(String encoded) &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (encoded == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="type">char</span>[] base64Data = encoded.toCharArray();</span><br><span class="line">        <span class="comment">// remove white spaces</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> removeWhiteSpace(base64Data);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (len % FOURBYTE != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;<span class="comment">//should be divisible by four</span></span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">numberQuadruple</span> <span class="operator">=</span> (len / FOURBYTE);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (numberQuadruple == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="type">byte</span> decodedData[] = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span> <span class="variable">b1</span> <span class="operator">=</span> <span class="number">0</span>, b2 = <span class="number">0</span>, b3 = <span class="number">0</span>, b4 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> <span class="variable">d1</span> <span class="operator">=</span> <span class="number">0</span>, d2 = <span class="number">0</span>, d3 = <span class="number">0</span>, d4 = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">encodedIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">dataIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        decodedData = <span class="keyword">new</span> <span class="title class_">byte</span>[(numberQuadruple) * <span class="number">3</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (; i &lt; numberQuadruple - <span class="number">1</span>; i++) &#123;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (!isData((d1 = base64Data[dataIndex++])) || !isData((d2 = base64Data[dataIndex++]))</span><br><span class="line">                || !isData((d3 = base64Data[dataIndex++]))</span><br><span class="line">                || !isData((d4 = base64Data[dataIndex++]))) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;<span class="comment">//if found &quot;no data&quot; just return null</span></span><br><span class="line"> </span><br><span class="line">            b1 = base64Alphabet[d1];</span><br><span class="line">            b2 = base64Alphabet[d2];</span><br><span class="line">            b3 = base64Alphabet[d3];</span><br><span class="line">            b4 = base64Alphabet[d4];</span><br><span class="line"> </span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (b1 &lt;&lt; <span class="number">2</span> | b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (((b2 &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>) | ((b3 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0xf</span>));</span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (b3 &lt;&lt; <span class="number">6</span> | b4);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (!isData((d1 = base64Data[dataIndex++])) || !isData((d2 = base64Data[dataIndex++]))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;<span class="comment">//if found &quot;no data&quot; just return null</span></span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        b1 = base64Alphabet[d1];</span><br><span class="line">        b2 = base64Alphabet[d2];</span><br><span class="line"> </span><br><span class="line">        d3 = base64Data[dataIndex++];</span><br><span class="line">        d4 = base64Data[dataIndex++];</span><br><span class="line">        <span class="keyword">if</span> (!isData((d3)) || !isData((d4))) &#123;<span class="comment">//Check if they are PAD characters</span></span><br><span class="line">            <span class="keyword">if</span> (isPad(d3) &amp;&amp; isPad(d4)) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((b2 &amp; <span class="number">0xf</span>) != <span class="number">0</span>)<span class="comment">//last 4 bits should be zero</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">byte</span>[] tmp = <span class="keyword">new</span> <span class="title class_">byte</span>[i * <span class="number">3</span> + <span class="number">1</span>];</span><br><span class="line">                System.arraycopy(decodedData, <span class="number">0</span>, tmp, <span class="number">0</span>, i * <span class="number">3</span>);</span><br><span class="line">                tmp[encodedIndex] = (<span class="type">byte</span>) (b1 &lt;&lt; <span class="number">2</span> | b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">                <span class="keyword">return</span> tmp;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isPad(d3) &amp;&amp; isPad(d4)) &#123;</span><br><span class="line">                b3 = base64Alphabet[d3];</span><br><span class="line">                <span class="keyword">if</span> ((b3 &amp; <span class="number">0x3</span>) != <span class="number">0</span>)<span class="comment">//last 2 bits should be zero</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">byte</span>[] tmp = <span class="keyword">new</span> <span class="title class_">byte</span>[i * <span class="number">3</span> + <span class="number">2</span>];</span><br><span class="line">                System.arraycopy(decodedData, <span class="number">0</span>, tmp, <span class="number">0</span>, i * <span class="number">3</span>);</span><br><span class="line">                tmp[encodedIndex++] = (<span class="type">byte</span>) (b1 &lt;&lt; <span class="number">2</span> | b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">                tmp[encodedIndex] = (<span class="type">byte</span>) (((b2 &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>) | ((b3 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0xf</span>));</span><br><span class="line">                <span class="keyword">return</span> tmp;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//No PAD e.g 3cQl</span></span><br><span class="line">            b3 = base64Alphabet[d3];</span><br><span class="line">            b4 = base64Alphabet[d4];</span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (b1 &lt;&lt; <span class="number">2</span> | b2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (((b2 &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>) | ((b3 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0xf</span>));</span><br><span class="line">            decodedData[encodedIndex++] = (<span class="type">byte</span>) (b3 &lt;&lt; <span class="number">6</span> | b4);</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> decodedData;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * remove WhiteSpace from MIME containing encoded Base64 data.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data  the byte array of base64 data (with WS)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>      the new length</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">removeWhiteSpace</span><span class="params">(<span class="type">char</span>[] data)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// count characters that&#x27;s not whitespace</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">newSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> data.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isWhiteSpace(data[i])) &#123;</span><br><span class="line">                data[newSize++] = data[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> newSize;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="HexUtil-java"><a href="#HexUtil-java" class="headerlink" title="HexUtil.java"></a>HexUtil.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HexUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] DIGITS_LOWER = &#123; <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span> &#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] DIGITS_UPPER = &#123; <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将byte数组转为16进制</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">bytes2Hex</span><span class="params">(<span class="type">byte</span>[] src)</span>&#123;         </span><br><span class="line">        <span class="type">char</span>[] res = <span class="keyword">new</span> <span class="title class_">char</span>[src.length*<span class="number">2</span>];    </span><br><span class="line">        <span class="keyword">final</span> <span class="type">char</span> hexDigits[]=&#123;<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>&#125;;    </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>; i&lt;src.length; i++)&#123;    </span><br><span class="line">            res[j++] = hexDigits[src[i] &gt;&gt;&gt;<span class="number">4</span> &amp; <span class="number">0x0f</span>];    </span><br><span class="line">            res[j++] = hexDigits[src[i] &amp; <span class="number">0x0f</span>];    </span><br><span class="line">        &#125;    </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(res);    </span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将16进制转为byte数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] hex2Bytes(String src)&#123;  </span><br><span class="line">        <span class="type">byte</span>[] res = <span class="keyword">new</span> <span class="title class_">byte</span>[src.length()/<span class="number">2</span>];  </span><br><span class="line">        <span class="type">char</span>[] chs = src.toCharArray();  </span><br><span class="line">        <span class="type">int</span>[] b = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,c=<span class="number">0</span>; i&lt;chs.length; i+=<span class="number">2</span>,c++)&#123;              </span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">2</span>; j++)&#123;  </span><br><span class="line">                <span class="keyword">if</span>(chs[i+j]&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; chs[i+j]&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;  </span><br><span class="line">                    b[j] = (chs[i+j]-<span class="string">&#x27;0&#x27;</span>);  </span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(chs[i+j]&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; chs[i+j]&lt;=<span class="string">&#x27;F&#x27;</span>)&#123;  </span><br><span class="line">                    b[j] = (chs[i+j]-<span class="string">&#x27;A&#x27;</span>+<span class="number">10</span>);  </span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(chs[i+j]&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; chs[i+j]&lt;=<span class="string">&#x27;f&#x27;</span>)&#123;  </span><br><span class="line">                    b[j] = (chs[i+j]-<span class="string">&#x27;a&#x27;</span>+<span class="number">10</span>);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;   </span><br><span class="line"></span><br><span class="line">            b[<span class="number">0</span>] = (b[<span class="number">0</span>]&amp;<span class="number">0x0f</span>)&lt;&lt;<span class="number">4</span>;  </span><br><span class="line">            b[<span class="number">1</span>] = (b[<span class="number">1</span>]&amp;<span class="number">0x0f</span>);  </span><br><span class="line">            res[c] = (<span class="type">byte</span>) (b[<span class="number">0</span>] | b[<span class="number">1</span>]);  </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] decodeHex(<span class="keyword">final</span> <span class="type">char</span>[] data) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> data.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((len &amp; <span class="number">0x01</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;Odd number of characters.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">byte</span>[] out = <span class="keyword">new</span> <span class="title class_">byte</span>[len &gt;&gt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// two characters form the hex value.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>; j &lt; len; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">f</span> <span class="operator">=</span> toDigit(data[j], j) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">            j++;</span><br><span class="line">            f = f | toDigit(data[j], j);</span><br><span class="line">            j++;</span><br><span class="line">            out[i] = (<span class="type">byte</span>) (f &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">toDigit</span><span class="params">(<span class="keyword">final</span> <span class="type">char</span> ch, <span class="keyword">final</span> <span class="type">int</span> index)</span></span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">digit</span> <span class="operator">=</span> Character.digit(ch, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">if</span> (digit == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;Illegal hexadecimal character &quot;</span> + ch</span><br><span class="line">                    + <span class="string">&quot; at index &quot;</span> + index);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> digit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span>[] encodeHex(<span class="keyword">final</span> <span class="type">byte</span>[] data) &#123;</span><br><span class="line">        <span class="keyword">return</span> encodeHex(data, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span>[] encodeHex(<span class="keyword">final</span> <span class="type">byte</span>[] data, <span class="keyword">final</span> <span class="type">boolean</span> toLowerCase) &#123;</span><br><span class="line">        <span class="keyword">return</span> encodeHex(data, toLowerCase ? DIGITS_LOWER : DIGITS_UPPER);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="type">char</span>[] encodeHex(<span class="keyword">final</span> <span class="type">byte</span>[] data, <span class="keyword">final</span> <span class="type">char</span>[] toDigits) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> data.length;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">char</span>[] out = <span class="keyword">new</span> <span class="title class_">char</span>[l &lt;&lt; <span class="number">1</span>];</span><br><span class="line">        <span class="comment">// two characters form the hex value.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">            out[j++] = toDigits[(<span class="number">0xF0</span> &amp; data[i]) &gt;&gt;&gt; <span class="number">4</span>];</span><br><span class="line">            out[j++] = toDigits[<span class="number">0x0F</span> &amp; data[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> out;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RSAEncrypt-java"><a href="#RSAEncrypt-java" class="headerlink" title="RSAEncrypt.java"></a>RSAEncrypt.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 非对称加密采用RSA加密算法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RSAEncrypt</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> PublicKey publicKey;</span><br><span class="line">    <span class="keyword">private</span> PrivateKey privateKey;</span><br><span class="line">    <span class="keyword">private</span> String publicKeyString;</span><br><span class="line">    <span class="keyword">private</span> String privateKeyString;</span><br><span class="line">    <span class="comment">// 加解密类</span></span><br><span class="line">    <span class="keyword">private</span> Cipher cipher;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RSAEncrypt</span><span class="params">(PublicKey publicKey, PrivateKey privateKey)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.publicKey = publicKey;</span><br><span class="line">        <span class="built_in">this</span>.privateKey = privateKey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加密</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encrypt</span><span class="params">(String string)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">afterEncrypt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 加解密类</span></span><br><span class="line">            cipher = Cipher.getInstance(<span class="string">&quot;RSA&quot;</span>);<span class="comment">// Cipher.getInstance(&quot;RSA/ECB/PKCS1Padding&quot;);</span></span><br><span class="line">            <span class="comment">// 明文</span></span><br><span class="line">            <span class="type">byte</span>[] plainText = string.getBytes();</span><br><span class="line">            <span class="comment">// 公钥加密</span></span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line">            <span class="type">byte</span>[] enBytes = cipher.doFinal(plainText); </span><br><span class="line">            afterEncrypt = HexUtil.bytes2Hex(enBytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> afterEncrypt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解密</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decrypt</span><span class="params">(String string)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] bytes = HexUtil.hex2Bytes(string);</span><br><span class="line">        <span class="type">String</span> <span class="variable">afterDecrypt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// 加解密类</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cipher = Cipher.getInstance(<span class="string">&quot;RSA&quot;</span>);<span class="comment">// Cipher.getInstance(&quot;RSA/ECB/PKCS1Padding&quot;);</span></span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line">            <span class="type">byte</span>[] deBytes = cipher.doFinal(bytes);</span><br><span class="line">            publicKeyString = getKeyString(publicKey);</span><br><span class="line">            privateKeyString = getKeyString(privateKey);</span><br><span class="line">            afterDecrypt = <span class="keyword">new</span> <span class="title class_">String</span>(deBytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> afterDecrypt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到密钥字符串（经过base64编码）</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getKeyString</span><span class="params">(Key key)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">byte</span>[] keyBytes = key.getEncoded();</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> <span class="title class_">BASE64Encoder</span>()).encode(keyBytes);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-tags"><a href="/tags/java/" rel="tag"># java</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2018/09/13/MarkDown%E8%AF%AD%E6%B3%95%E5%88%9D%E8%AF%86/" rel="prev" title="MarkDown语法初识"><i class="fa fa-angle-left"></i> MarkDown语法初识</a></div><div class="post-nav-item"><a href="/2018/09/18/%E5%80%BC%E4%BC%A0%E9%80%92%E9%97%AE%E9%A2%98%E4%B8%8E%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92/" rel="next" title="值传递问题与引用传递">值传递问题与引用传递 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">一只写Bug的猫</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>站点总字数：</span> <span title="站点总字数">2.7m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>站点阅读时长 &asymp;</span> <span title="站点阅读时长">40:35</span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a href="https://github.com/AsummerCat/AsmmerCatHexo" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();</script></body></html>